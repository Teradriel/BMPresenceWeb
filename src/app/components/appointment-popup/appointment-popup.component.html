<div class="popup-overlay" *ngIf="isVisible" (click)="onCancel()">
  <div class="popup-content" (click)="$event.stopPropagation()">
    <div class="popup-header">
      <h2>A chi vuoi assegnare?</h2>
    </div>

    <div class="popup-body">
      <div class="appointment-info" *ngIf="appointmentData">
        <p>{{ appointmentData.resourceName }}</p>
        <p>
          <strong>Data:</strong>
          {{ appointmentData.startTime | date: "dd/MM/yyyy" }}
        </p>
      </div>

      <button class="btn btn-primary full-width" (click)="onAssignToMe()">
        âœ“ Assegna a me
      </button>

      <div class="divider">
        <span>oppure...</span>
      </div>

      <div class="form-group">
        <label for="userSelect">Scegli un collega</label>
        <select id="userSelect" class="form-control" [(ngModel)]="selectedUser">
          <option [ngValue]="undefined">Seleziona un utente...</option>
          <option *ngFor="let user of sortedUsers" [ngValue]="user">
            {{
              user.fullName || user.name + " " + user.lastName || user.username
            }}
          </option>
        </select>
      </div>

      <button
        class="btn btn-secondary full-width"
        [disabled]="!isAssignButtonEnabled"
        (click)="onAssignToSelectedUser()"
      >
        âœ“ Assegna al collega selezionato
      </button>

      <button
        *ngIf="isEditMode"
        class="btn btn-danger full-width"
        (click)="onDelete()"
      >
        ğŸ—‘ï¸ Elimina Appuntamento
      </button>

      <button class="btn btn-cancel full-width" (click)="onCancel()">
        âœ• Annulla
      </button>
    </div>
  </div>
</div>
